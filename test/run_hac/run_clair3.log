[INFO] CLAIR3 VERSION: v1.2.0
[INFO] BAM FILE PATH: /autofs/bal19/xyu/ont_open_data/HG001/hac_calls/downsample/HG001_30x.bam
[INFO] REFERENCE FILE PATH: /autofs/bal19/zxzheng/testData/ont/data/GRCh38_no_alt_analysis_set.fasta
[INFO] MODEL PATH: /autofs/nas5/xyu2/projects/Clair3_mv/hg002_hac/torch_model
[INFO] OUTPUT FOLDER: /autofs/nas5/xyu2/softwares/Clair3_no_change_v1.2_torch/test/run_hac
[INFO] PLATFORM: ont
[INFO] THREADS: 60
[INFO] BED FILE PATH: EMPTY
[INFO] VCF FILE PATH: EMPTY
[INFO] CONTIGS: chr20
[INFO] CONDA PREFIX: /autofs/nas5/xyu2/softwares/miniforge3/envs/clair3-torch
[INFO] SAMTOOLS PATH: samtools
[INFO] PYTHON PATH: python3
[INFO] PYPY PATH: pypy3
[INFO] PARALLEL PATH: parallel
[INFO] WHATSHAP PATH: whatshap
[INFO] LONGPHASE PATH: EMPTY
[INFO] CHUNK SIZE: 5000000
[INFO] FULL ALIGN PROPORTION: 0.7
[INFO] FULL ALIGN REFERENCE PROPORTION: 0.1
[INFO] PHASING PROPORTION: 0.7
[INFO] MINIMUM MQ: 5
[INFO] MINIMUM COVERAGE: 2
[INFO] SNP AF THRESHOLD: 0.08
[INFO] INDEL AF THRESHOLD: 0.15
[INFO] BASE ERROR IN GVCF: 0.001
[INFO] GQ BIN SIZE IN GVCF: 5
[INFO] ENABLE FILEUP ONLY CALLING: False
[INFO] ENABLE FAST MODE CALLING: False
[INFO] ENABLE CALLING SNP CANDIDATES ONLY: False
[INFO] ENABLE PRINTING REFERENCE CALLS: False
[INFO] ENABLE OUTPUT GVCF: False
[INFO] ENABLE HAPLOID PRECISE MODE: False
[INFO] ENABLE HAPLOID SENSITIVE MODE: False
[INFO] ENABLE INCLUDE ALL CTGS CALLING: False
[INFO] ENABLE NO PHASING FOR FULL ALIGNMENT: False
[INFO] ENABLE REMOVING INTERMEDIATE FILES: False
[INFO] ENABLE LONGPHASE FOR INTERMEDIATE VCF PHASING: False
[INFO] ENABLE PHASING FINAL VCF OUTPUT USING WHATSHAP: False
[INFO] ENABLE PHASING FINAL VCF OUTPUT USING LONGPHASE: False
[INFO] ENABLE HAPLOTAGGING FINAL BAM: False
[INFO] ENABLE LONG INDEL CALLING: False
[INFO] ENABLE C_IMPLEMENT: True
[INFO] ENABLE DWELL TIME: True

+ /autofs/nas5/xyu2/softwares/Clair3_no_change_v1.2_torch/scripts/clair3_c_impl.sh --bam_fn /autofs/bal19/xyu/ont_open_data/HG001/hac_calls/downsample/HG001_30x.bam --ref_fn /autofs/bal19/zxzheng/testData/ont/data/GRCh38_no_alt_analysis_set.fasta --threads 60 --model_path /autofs/nas5/xyu2/projects/Clair3_mv/hg002_hac/torch_model --platform ont --output /autofs/nas5/xyu2/softwares/Clair3_no_change_v1.2_torch/test/run_hac --bed_fn=EMPTY --vcf_fn=EMPTY --ctg_name=chr20 --sample_name=SAMPLE --chunk_num=0 --chunk_size=5000000 --samtools=samtools --python=python3 --pypy=pypy3 --parallel=parallel --whatshap=whatshap --qual=2 --var_pct_full=0.7 --ref_pct_full=0.1 --var_pct_phasing=0.7 --snp_min_af=0.08 --indel_min_af=0.15 --min_mq=5 --min_coverage=2 --min_contig_size=0 --pileup_only=False --gvcf=False --base_err=0.001 --gq_bin_size=5 --fast_mode=False --call_snp_only=False --enable_variant_calling_at_sequence_head_and_tail=False --output_all_contigs_in_gvcf_header=False --print_ref_calls=False --haploid_precise=False --haploid_sensitive=False --include_all_ctgs=False --no_phasing_for_fa=False --pileup_model_prefix=pileup --fa_model_prefix=full_alignment --remove_intermediate_dir=False --enable_phasing=False --enable_long_indel=False --keep_iupac_bases=False --use_gpu=False --device=EMPTY --longphase_for_phasing=False --longphase=EMPTY --use_whatshap_for_intermediate_phasing=True --use_longphase_for_intermediate_phasing=False --use_whatshap_for_final_output_phasing=False --use_longphase_for_final_output_phasing=False --use_whatshap_for_final_output_haplotagging=False --enable_dwell_time=True

[INFO] Check environment variables
[INFO] Call variant in contigs: chr20
[INFO] Chunk number for each contig: 13
[INFO] 1/7 Call variants using pileup model
Calling variants ...
Total processed positions in chr20 (chunk 9/13) : 27381
Total time elapsed: 58.44 s
Calling variants ...
Total processed positions in chr20 (chunk 3/13) : 32363
Total time elapsed: 61.11 s
Calling variants ...
Total processed positions in chr20 (chunk 8/13) : 31210
Total time elapsed: 61.72 s
Calling variants ...
Total processed positions in chr20 (chunk 5/13) : 32680
Total time elapsed: 62.32 s
Calling variants ...
Total processed positions in chr20 (chunk 4/13) : 34425
Total time elapsed: 64.78 s
Calling variants ...
Total processed positions in chr20 (chunk 2/13) : 35164
Total time elapsed: 64.65 s
Calling variants ...
Total processed positions in chr20 (chunk 10/13) : 34997
Total time elapsed: 64.97 s
Calling variants ...
Total processed positions in chr20 (chunk 11/13) : 35486
Total time elapsed: 68.22 s
Calling variants ...
Total processed positions in chr20 (chunk 12/13) : 37095
Total time elapsed: 68.43 s
Calling variants ...
Total processed positions in chr20 (chunk 1/13) : 39308
Total time elapsed: 70.56 s
Calling variants ...
Total processed positions in chr20 (chunk 13/13) : 43176
Total time elapsed: 73.18 s
Calling variants ...
Total processed positions in chr20 (chunk 7/13) : 80742
Total time elapsed: 115.65 s
Calling variants ...
Total processed positions in chr20 (chunk 6/13) : 120467
Total time elapsed: 147.16 s

real	2m34.225s
user	11m55.579s
sys	5m16.367s

[INFO] 2/7 Select heterozygous SNP variants for Whatshap phasing and haplotagging
[INFO] Select heterozygous pileup variants exceeding phasing quality cutoff 14
[INFO] Total heterozygous SNP positions selected: chr20: 60175

real	0m1.905s
user	0m1.460s
sys	0m0.288s

[INFO] 3/7 Phase VCF file using Whatshap
This is WhatsHap 2.8 running under Python 3.11.14
Working on 1 sample from 1 family

# Working on contig chr20 in individual SAMPLE
Found 60175 usable heterozygous variants (0 skipped due to missing genotypes)
Number of supplementary alignments: 0
Number of non-singleton groups: 0
Skipped 0 groups
Found 85823 reads covering 57944 variants
Kept 74095 reads that cover at least two variants each
Selected 27293 most phase-informative reads covering 57931 variants
Phasing 1 sample by solving the MEC problem ...
Largest block contains 2968 variants (5.1% of accessible variants) between position 29204944 and 29564021
Changed 527 genotypes while writing VCF

# Resource usage
Maximum memory usage: 0.560 GB
Time spent reading BAM/CRAM:                   83.4 s
Time spent parsing VCF:                         1.6 s
Time spent selecting reads:                    23.5 s
Time spent phasing:                           271.2 s
Time spent writing VCF:                         1.8 s
Time spent finding components:                  0.8 s
Time spent on rest:                             5.8 s
Total elapsed time:                           388.1 s

real	6m45.971s
user	6m24.048s
sys	0m3.634s

[INFO] 5/7 Select candidates for full-alignment calling
[INFO] Set variants quality cutoff 22.0
[INFO] Set reference calls quality cutoff 11.0
[INFO] Low quality reference calls to be processed in chr20: 43335
[INFO] Low quality variants to be processed in chr20: 105200

real	0m1.431s
user	0m1.163s
sys	0m0.333s

[INFO] 6/7 Call low-quality variants using full-alignment model
Calling variants ...
Total processed positions in chr20 (chunk 10/15) : 10000
Total time elapsed: 58.02 s
Calling variants ...
Total processed positions in chr20 (chunk 15/15) : 8535
Total time elapsed: 59.37 s
Calling variants ...
Total processed positions in chr20 (chunk 5/15) : 10000
Total time elapsed: 61.07 s
Calling variants ...
Total processed positions in chr20 (chunk 4/15) : 10000
Total time elapsed: 62.51 s
Calling variants ...
Total processed positions in chr20 (chunk 8/15) : 10000
Total time elapsed: 63.14 s
Calling variants ...
Total processed positions in chr20 (chunk 6/15) : 10000
Total time elapsed: 63.75 s
Calling variants ...
Total processed positions in chr20 (chunk 7/15) : 10000
Total time elapsed: 65.43 s
Calling variants ...
Total processed positions in chr20 (chunk 9/15) : 10000
Total time elapsed: 65.35 s
Calling variants ...
Total processed positions in chr20 (chunk 11/15) : 10000
Total time elapsed: 66.24 s
Calling variants ...
Total processed positions in chr20 (chunk 1/15) : 10000
Total time elapsed: 70.00 s
Calling variants ...
Total processed positions in chr20 (chunk 13/15) : 10000
Total time elapsed: 70.52 s
Calling variants ...
Total processed positions in chr20 (chunk 2/15) : 10000
Total time elapsed: 71.99 s
Calling variants ...
Total processed positions in chr20 (chunk 12/15) : 10000
Total time elapsed: 73.50 s
Calling variants ...
Total processed positions in chr20 (chunk 14/15) : 10000
Total time elapsed: 73.52 s
Calling variants ...
Total processed positions in chr20 (chunk 3/15) : 10000
Total time elapsed: 78.71 s

real	1m29.600s
user	14m46.667s
sys	2m41.992s

[INFO] 7/7 Merge pileup VCF and full-alignment VCF
[INFO] Pileup variants processed in chr20: 45166
[INFO] Full-alignment variants processed in chr20: 94233

real	0m2.086s
user	0m2.330s
sys	0m0.358s

[INFO] Finish calling, output file: /autofs/nas5/xyu2/softwares/Clair3_no_change_v1.2_torch/test/run_hac/merge_output.vcf.gz

real	11m17.323s
user	33m20.207s
sys	8m4.834s
